import os
import sys
import asyncio

# Add the project root to PYTHONPATH
project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
if project_root not in sys.path:
    sys.path.append(project_root)

from services.gh_question_service import GHQuestionService

g = GHQuestionService()
q = "보험료 미납이 인정되는 면책 기간이나 사유가 있는지 알려주세요. 그리고 미납으로 인해 계약이 실효된 경우, 다시 부활이 가능한지 알려주세요. 부활시 불이익이 있다면 알려주세요."
async def normal():
    documents = await g.search_documents(q)
    return g.generate_answer(q, documents)

def split():
    return g.process_question(q)

if __name__ == '__main__':
    #print(asyncio.run(normal()))
    print(split())
nornal_answer = """
보험료 미납 시 적용되는 절차와 해지·부활 관련 주요 사항은 NH농협생명 암보험(주계약) 약관에서 공통적으로 다음과 같습니다.

1. 납입최고(독촉) 기간  
    - 보험료를 기한 내에 납입하지 않으면 회사는 14일 이상의 납입최고(독촉) 기간을 서면·전화·전자문서 등으로 안내합니다.  
    - 납입최고 기간이 끝날 때까지 보험료를 납입하지 않으면, 그 다음 날에 계약(주계약 및 미납 특약)이 해지됩니다.  
      (약관 조문 예)  
        • 369뉴테크NH암보험(무배당) 제32조·항암양성자방사선치료특약 제22조  
        • 새로나온NH암보험(갱신·비갱신·무배당) 제29조  
        • 행복두배NH통합암보험·해피콜행복나눔NH통합암보험 제29조  
        • NHe편한암보험 제31조  
    (모두 “주계약 및 특약 해지” 규정)

2. 계약 해지 후 부활(효력회복)  
    - 해약환급금을 수령하지 않은 상태에서 해지된 경우, 해지일로부터 3년 이내에 부활 청약이 가능합니다.  
    - 부활 승낙 시에는 ‘연체된 보험료 전액’에 “평균공시이율+1% 이율 범위 내에서 회사가 정한 이율”로 계산된 이자를 더해 납입하면 됩니다.  
    - 보장 범위는 원계약과 동일하게 회복되며, 해지 전 발생한 보험금 지급사유로 부활을 거절하지 않습니다.  
    - 다만 최초 청약 시 알릴 의무(건강·고지 의무)를 위반했다면, 부활 후에도 그 위반에 따른 삭감·부지급 등의 제재가 적용될 수 있습니다.  
      (약관 조문 예)  
        • 369뉴테크NH암보험(무배당) 제32조  
        • 새로나온NH암보험(갱신·비갱신·무배당) 제29조  
        • 행복두배NH통합암보험·해피콜행복나눔NH통합암보험 제29조  
        • NHe편한암보험 제31조  
    (모두 “계약의 부활(효력회복)” 규정)

3. 요약  
    • 면책(납입최고) 기간: 최소 14일  
    • 해지 후 부활 가능 기간: 해지일로부터 3년 이내  
    • 부활 조건: 연체 보험료 전액 + 평균공시이율+1% 이자 납입  
    • 불이익: 최초 고지의무 위반 시 부활 후에도 해당 위반에 따른 보상제한  

출처:  
    NH농협생명 369뉴테크NH암보험 |무배당|_2404 주계약 약관  
    NH농협생명 새로나온NH암보험 |갱신형,비갱신형,무배당|_2404 주계약 약관  
    NH농협생명 행복두배NH통합암보험 |갱신형,비갱신형,무배당|_2404 주계약 약관  
    NH농협생명 해피콜 행복나눔NH통합암보험 |갱신형,비갱신형,무배당|_2404 주계약 약관  
    NH농협생명 NHe편한암보험 |갱신형,비갱신형,무배당| 주계약 약관
보험료 미납 시 적용되는 절차와 해지·부활 관련 주요 사항은 NH농협생명 암보험(주계약) 약관에서 공통적으로 다음과 같습니다.

1. 납입최고(독촉) 기간  
    - 보험료를 기한 내에 납입하지 않으면 회사는 14일 이상의 납입최고(독촉) 기간을 서면·전화·전자문서 등으로 안내합니다.  
    - 납입최고 기간이 끝날 때까지 보험료를 납입하지 않으면, 그 다음 날에 계약(주계약 및 미납 특약)이 해지됩니다.  
      (약관 조문 예)  
        • 369뉴테크NH암보험(무배당) 제32조·항암양성자방사선치료특약 제22조  
        • 새로나온NH암보험(갱신·비갱신·무배당) 제29조  
        • 행복두배NH통합암보험·해피콜행복나눔NH통합암보험 제29조  
        • NHe편한암보험 제31조  
    (모두 “주계약 및 특약 해지” 규정)

2. 계약 해지 후 부활(효력회복)  
    - 해약환급금을 수령하지 않은 상태에서 해지된 경우, 해지일로부터 3년 이내에 부활 청약이 가능합니다.  
    - 부활 승낙 시에는 ‘연체된 보험료 전액’에 “평균공시이율+1% 이율 범위 내에서 회사가 정한 이율”로 계산된 이자를 더해 납입하면 됩니다.  
    - 보장 범위는 원계약과 동일하게 회복되며, 해지 전 발생한 보험금 지급사유로 부활을 거절하지 않습니다.  
    - 다만 최초 청약 시 알릴 의무(건강·고지 의무)를 위반했다면, 부활 후에도 그 위반에 따른 삭감·부지급 등의 제재가 적용될 수 있습니다.  
      (약관 조문 예)  
        • 369뉴테크NH암보험(무배당) 제32조  
        • 새로나온NH암보험(갱신·비갱신·무배당) 제29조  
        • 행복두배NH통합암보험·해피콜행복나눔NH통합암보험 제29조  
        • NHe편한암보험 제31조  
    (모두 “계약의 부활(효력회복)” 규정)

3. 요약  
    • 면책(납입최고) 기간: 최소 14일  
    • 해지 후 부활 가능 기간: 해지일로부터 3년 이내  
    • 부활 조건: 연체 보험료 전액 + 평균공시이율+1% 이자 납입  
    • 불이익: 최초 고지의무 위반 시 부활 후에도 해당 위반에 따른 보상제한  

출처:  
    NH농협생명 369뉴테크NH암보험 |무배당|_2404 주계약 약관  
    NH농협생명 새로나온NH암보험 |갱신형,비갱신형,무배당|_2404 주계약 약관  
    NH농협생명 행복두배NH통합암보험 |갱신형,비갱신형,무배당|_2404 주계약 약관  
    NH농협생명 해피콜 행복나눔NH통합암보험 |갱신형,비갱신형,무배당|_2404 주계약 약관  
    NH농협생명 NHe편한암보험 |갱신형,비갱신형,무배당| 주계약 약관
"""
split_answer = """
1. 주요 내용 요약  
   가. 보험료 미납 인정 기간·사유  
     - 모든 주계약 및 특약에 대해 납입기일 다음 날부터 납입최고(독촉)기간을 부여  
       · 원칙적으로 14일(단, 보험기간 1년 미만 특약은 7일)  
       · 이 기간 내 미납 시 해당 계약(주계약·특약) 자동 해지  
     - 별도 면책 기간·사유는 없으나, 369뉴테크NH암보험(무배당)의 “암납입면제특약” 가입 시  
       · 고객이 소정의 암 진단·치료를 받은 경우, 별도 신청서류 접수 후 3영업일(최대 10영업일) 내 보험료 납입 면제  

   나. 해지된 계약의 부활(효력회복) 가능 여부  
     - 가능 기간: 해지일로부터 3년 이내  
     - 절차  
       1) 회사 소정의 부활청구서 등 제출  
       2) 해지 시점부터 부활 신청일까지의 미납보험료 전액 납입  
          · 지연이자: “평균공시이율＋1% 이내” 회사 지정 이율 적용  
       3) 부활 승인 통지 수령  
     - 승인 효과: 해지 직전의 보장 내용 그대로 효력 회복, 해지 전 발생사유(예: 암 진단)로 부활 거절 금지  

   다. 부활 시 불이익  
     1) 미납보험료 및 지연이자 추가 부담  
     2) 최초 계약 시 고지의무(건강상태 등) 위반 시 동일 제재 적용  
        · 부활 시에도 과거 고지위반 사실이 적발되면 계약 거절·해지·보험금 축소 가능  
     3) 부활 청약일의 보험료를 ‘제1회 보험료’로 간주하여 새로운 보험료율 적용  

2. 세부 비교표  
   공통 사항  
    - 납입최고기간: 14일(특약 1년 미만 시 7일)  
    - 부활 가능 기간: 해지 후 3년 이내  
    - 부활 지연이자: 평균공시이율＋1% 이내  
    - 부활 시 최초 고지의무 준수 및 불이익 동일 적용  
   추가 특약  
    - 369뉴테크NH암보험(무배당) 암납입면제특약: 암 진단·치료 시 면제  
      · 면제확정: 신청서류 접수일로부터 3영업일(최대 10영업일)  

3. 추가 유의사항  
   - 부활 승낙 전 암 진단·치료 사실로 인해 부활 거절되지 않으나, 고지의무 위반은 별도 검토  
   - 각 상품별 약관(제29~32조) 참조 권장  

4. 출처  
   - NH농협생명  
     · NHe편한암보험(갱신형·비갱신형·무배당) 주계약 약관 제31조  
     · 369뉴테크NH암보험(무배당) 주계약 약관 제32조  
     · 행복두배NH통합암보험(갱신형·비갱신형·무배당) 주계약 약관 제29조  
     · 새로나온NH암보험(갱신형·비갱신형·무배당) 주계약 약관 제29조  
     · 해피콜행복나눔NH통합암보험(갱신형·비갱신형·무배당) 주계약 약관 제29조
"""

